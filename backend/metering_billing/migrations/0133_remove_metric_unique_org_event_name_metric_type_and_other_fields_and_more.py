# Generated by Django 4.0.5 on 2022-12-27 19:03

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('metering_billing', '0132_alter_subscriptionrecord_unique_together_and_more'),
    ]

    operations = [
        migrations.RemoveConstraint(
            model_name='metric',
            name='unique_org_event_name_metric_type_and_other_fields',
        ),
        migrations.RemoveField(
            model_name='plancomponent',
            name='separate_by',
        ),
        migrations.AddField(
            model_name='historicalmetric',
            name='custom_sql_query',
            field=models.TextField(blank=True, help_text='A custom SQL query that can be used to define the metric. Please refer to our documentation for more information.', null=True),
        ),
        migrations.AddField(
            model_name='historicalorganization',
            name='subscription_filters_setting_provisioned',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='historicalorganizationsetting',
            name='setting_values',
            field=models.JSONField(blank=True, default=list),
        ),
        migrations.AddField(
            model_name='metric',
            name='custom_sql_query',
            field=models.TextField(blank=True, help_text='A custom SQL query that can be used to define the metric. Please refer to our documentation for more information.', null=True),
        ),
        migrations.AddField(
            model_name='organization',
            name='subscription_filters_setting_provisioned',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='organizationsetting',
            name='setting_values',
            field=models.JSONField(blank=True, default=list),
        ),
        migrations.AlterField(
            model_name='historicalmetric',
            name='metric_type',
            field=models.CharField(choices=[('counter', 'Counter'), ('stateful', 'Stateful'), ('rate', 'Rate'), ('custom', 'Custom')], default='counter', help_text='The type of metric that this is. Please refer to our documentation for an explanation of the different types.', max_length=20),
        ),
        migrations.AlterField(
            model_name='metric',
            name='metric_type',
            field=models.CharField(choices=[('counter', 'Counter'), ('stateful', 'Stateful'), ('rate', 'Rate'), ('custom', 'Custom')], default='counter', help_text='The type of metric that this is. Please refer to our documentation for an explanation of the different types.', max_length=20),
        ),
        migrations.AlterField(
            model_name='metric',
            name='organization',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='metrics', to='metering_billing.organization'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(fields=('organization', 'billable_metric_name'), name='unique_org_billable_metric_name'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'custom_sql_query', 'billable_metric_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'custom_sql_query', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__bi_me_na'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'custom_sql_query', 'billable_metric_name', 'usage_aggregation_type'), name='uq_metric_w_null__bi_ag_ty'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'custom_sql_query', 'billable_metric_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__pr_na'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'custom_sql_query', 'billable_metric_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('custom_sql_query__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'billable_metric_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_me_na_bi_ag_ty'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'billable_aggregation_type', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_me_na_pr_na'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'billable_aggregation_type', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_me_na_gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__bi_me_na_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'billable_metric_name', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_ag_ty_pr_na'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'billable_metric_name', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_ag_ty_gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('custom_sql_query__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'billable_metric_name', 'usage_aggregation_type'), name='uq_metric_w_null__bi_ag_ty_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'billable_aggregation_type', 'billable_metric_name', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__pr_na_gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('custom_sql_query__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'billable_metric_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__pr_na_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'billable_metric_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__gr_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_me_na_bi_ag_ty_pr_na'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_me_na_bi_ag_ty_gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'usage_aggregation_type'), name='uq_metric_w_null__bi_me_na_bi_ag_ty_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'billable_aggregation_type', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_me_na_pr_na_gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__bi_me_na_pr_na_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__bi_me_na_gr_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'billable_metric_name', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_ag_ty_pr_na_gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('custom_sql_query__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'billable_metric_name', 'usage_aggregation_type'), name='uq_metric_w_null__bi_ag_ty_pr_na_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'billable_metric_name', 'usage_aggregation_type'), name='uq_metric_w_null__bi_ag_ty_gr_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'billable_metric_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__pr_na_gr_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'usage_aggregation_type', 'custom_sql_query'), name='uq_metric_w_null__bi_me_na_bi_ag_ty_pr_na_gr'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'granularity', 'usage_aggregation_type'), name='uq_metric_w_null__bi_me_na_bi_ag_ty_pr_na_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('status', 'active')), fields=('metric_type', 'property_name', 'organization', 'is_cost_metric', 'event_name', 'usage_aggregation_type'), name='uq_metric_w_null__bi_me_na_bi_ag_ty_gr_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'usage_aggregation_type', 'billable_aggregation_type'), name='uq_metric_w_null__bi_me_na_pr_na_gr_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'billable_metric_name', 'usage_aggregation_type'), name='uq_metric_w_null__bi_ag_ty_pr_na_gr_cu_sq_qu'),
        ),
        migrations.AddConstraint(
            model_name='metric',
            constraint=models.UniqueConstraint(condition=models.Q(('billable_aggregation_type__in', [None, '']), ('billable_metric_name__in', [None, '']), ('custom_sql_query__in', [None, '']), ('granularity__in', [None, '']), ('property_name__in', [None, '']), ('status', 'active')), fields=('metric_type', 'organization', 'is_cost_metric', 'event_name', 'usage_aggregation_type'), name='uq_metric_w_null__bi_me_na_bi_ag_ty_pr_na_gr_cu_sq_qu'),
        ),
    ]
